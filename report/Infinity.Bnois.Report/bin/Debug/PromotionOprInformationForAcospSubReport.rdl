<?xml version="1.0" encoding="utf-8"?><Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2010/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner"><AutoRefresh>0</AutoRefresh><DataSources><DataSource Name="AppointmentProfileDS"><DataSourceReference>BnoisDataSource</DataSourceReference><rd:SecurityType>None</rd:SecurityType><rd:DataSourceID>da62982a-089f-45dc-ba29-7dc8ad9d9981</rd:DataSourceID></DataSource></DataSources><DataSets><DataSet Name="CommonDataSetDSet"><Query><DataSourceName>AppointmentProfileDS</DataSourceName><QueryParameters><QueryParameter Name="@EmployeeId"><Value>=Parameters!EmployeeId.Value</Value></QueryParameter></QueryParameters><CommandText>--declare @EmployeeId int = 936
--select * from Employee where Pno='1114'

select (select BranchId from EmployeeGeneral where EmployeeId=@EmployeeId) as Branch,
dbo.fnGetStaffDutiesByEmployeeId(@EmployeeId) as StaffDuties, 
isnull(dbo.fnGetInterServiceByEmployeeId(@EmployeeId),'Nil') as InterService,
isnull(dbo.fnGetDeputationServiceByEmployeeId(@EmployeeId),'Nil') as DeputationService,
isnull(dbo.fnGetInstructionServiceByEmployeeId(@EmployeeId),'Nil ') as InstructionService,
isnull(dbo.fnGetSeaServiceByEmployeeId(@EmployeeId),'Nil') as SeaService,
(case when (select BranchId from EmployeeGeneral where EmployeeId=@EmployeeId) in (1) then
 isnull('f. Comd svc - ' + (select stuff((select +', '+ X.Office from
(
select distinct TF.EmployeeId,O.ShortName  as Office,TF.FromDate,TF.ToDate, DATEDIFF(ss,TF.FromDate,TF.ToDate) as Duration
from Transfer TF
inner join Office O on TF.AttachOfficeId=O.OfficeId
inner join OfficeAppointment OA on TF.AppointmentId=OA.OffAppId
inner join AptNat  AN on OA.AptNatId=AN.ANatId
where OA.AptNatId=13 and OA.OfficeHead=1 and O.CmdService=1 --and O.PatternId=7 
--and (TF.FromDate&gt;=O.CommandServStartDate and TF.ToDate&lt;=isnull(O.CommandServEndDate,getdate()))
and TF.EmployeeId=@EmployeeId
) as X
for xml path('')),1,1,'') as Office),'f. Comd svc - Nil')
when (select BranchId from EmployeeGeneral where EmployeeId=@EmployeeId) in (5) then
 isnull('g. Comd svc - ' + (select stuff((select +', '+ X.Office from
(
select distinct TF.EmployeeId,O.ShortName  as Office,TF.FromDate,TF.ToDate, DATEDIFF(ss,TF.FromDate,TF.ToDate) as Duration
from Transfer TF
inner join Office O on TF.AttachOfficeId=O.OfficeId
inner join OfficeAppointment OA on TF.AppointmentId=OA.OffAppId
inner join AptNat  AN on OA.AptNatId=AN.ANatId
where OA.AptNatId=13 and OA.OfficeHead=1 and O.CmdService=1 --and O.PatternId=7 
--and (TF.FromDate&gt;=O.CommandServStartDate and TF.ToDate&lt;=isnull(O.CommandServEndDate,getdate()))
and TF.EmployeeId=@EmployeeId
) as X
for xml path('')),1,1,'') as Office),'g. Comd svc - Nil') else '' end) as CommandService,
(case when (select BranchId from EmployeeGeneral where EmployeeId=@EmployeeId)=2 then
(isnull('f. EO svc - ' + dbo.fnGetEoSoLoServiceByEmployeeIdAndAppt(@EmployeeId,51), 'f. EO svc - Nil'))
 when (select BranchId from EmployeeGeneral where EmployeeId=@EmployeeId)=5 then
(isnull('f. SO svc - ' + dbo.fnGetEoSoLoServiceByEmployeeIdAndAppt(@EmployeeId,52), 'f. SO svc - Nil'))
 when (select BranchId from EmployeeGeneral where EmployeeId=@EmployeeId)=7 then
(isnull('f. LO svc - ' + dbo.fnGetEoSoLoServiceByEmployeeIdAndAppt(@EmployeeId,54), 'f. LO svc - Nil'))
else '' end) as EolosoService</CommandText></Query><Fields><Field Name="Branch"><DataField>Branch</DataField><rd:TypeName>System.Int32</rd:TypeName></Field><Field Name="StaffDuties"><DataField>StaffDuties</DataField><rd:TypeName>System.String</rd:TypeName></Field><Field Name="InterService"><DataField>InterService</DataField><rd:TypeName>System.String</rd:TypeName></Field><Field Name="DeputationService"><DataField>DeputationService</DataField><rd:TypeName>System.String</rd:TypeName></Field><Field Name="InstructionService"><DataField>InstructionService</DataField><rd:TypeName>System.String</rd:TypeName></Field><Field Name="CommandService"><DataField>CommandService</DataField><rd:TypeName>System.String</rd:TypeName></Field><Field Name="SeaService"><DataField>SeaService</DataField><rd:TypeName>System.String</rd:TypeName></Field><Field Name="EolosoService"><DataField>EolosoService</DataField><rd:TypeName>System.String</rd:TypeName></Field></Fields></DataSet><DataSet Name="LastOprRecom"><Query><DataSourceName>AppointmentProfileDS</DataSourceName><QueryParameters><QueryParameter Name="@EmployeeId"><Value>=Parameters!EmployeeId.Value</Value></QueryParameter></QueryParameters><CommandText>select top(3) RT.ShortName  + FORMAT(CAST(EO.OprToDate AS DATE), ' (MMM)-yy') as Recom,  EO.OprGrade 
from EmployeeOpr EO
inner join RecomandationType RT on EO.RecomandationTypeId=RT.RecomandationTypeId 
where EmployeeId=@EmployeeId and OprRankId=(select RankId from Employee where EmployeeId=@EmployeeId)
order by Id desc</CommandText></Query><Fields><Field Name="Recom"><DataField>Recom</DataField><rd:TypeName>System.String</rd:TypeName></Field><Field Name="OprGrade"><DataField>OprGrade</DataField><rd:TypeName>System.Double</rd:TypeName></Field></Fields></DataSet><DataSet Name="ApptRecom"><Query><DataSourceName>AppointmentProfileDS</DataSourceName><QueryParameters><QueryParameter Name="@EmployeeId"><Value>=Parameters!EmployeeId.Value</Value></QueryParameter></QueryParameters><CommandText>select (select top(1) X.ApptRecom + ' - '+ cast(format(X.OprToDate,'MMM yy') as varchar(20))+''  from
(
select  top(3) ApptRecom,OprToDate from EmployeeOpr
where EmployeeId=@EmployeeId
order by OprToDate desc
) as X where X.ApptRecom is not null) as ApptRecom</CommandText></Query><Fields><Field Name="ApptRecom"><DataField>ApptRecom</DataField><rd:TypeName>System.String</rd:TypeName></Field></Fields></DataSet><DataSet Name="AllOprAvg"><Query><DataSourceName>AppointmentProfileDS</DataSourceName><QueryParameters><QueryParameter Name="@EmployeeId"><Value>=Parameters!EmployeeId.Value</Value></QueryParameter></QueryParameters><CommandText>select round(avg(OprGrade),2) as AvgOPR from EmployeeOpr where EmployeeId=@EmployeeId</CommandText></Query><Fields><Field Name="AvgOPR"><DataField>AvgOPR</DataField><rd:TypeName>System.Double</rd:TypeName></Field></Fields></DataSet><DataSet Name="Last5Oprs"><Query><DataSourceName>AppointmentProfileDS</DataSourceName><QueryParameters><QueryParameter Name="@EmployeeId"><Value>=Parameters!EmployeeId.Value</Value></QueryParameter></QueryParameters><CommandText>select round(avg(sub.OprGrade),2) as AvgOPR from
(select top 5 OprGrade from EmployeeOpr 
where EmployeeId=@EmployeeId and OprGrade&gt;=6.5
order by OprToDate) as sub</CommandText></Query><Fields><Field Name="AvgOPR"><DataField>AvgOPR</DataField><rd:TypeName>System.Double</rd:TypeName></Field></Fields></DataSet><DataSet Name="CdrRankOpr"><Query><DataSourceName>AppointmentProfileDS</DataSourceName><QueryParameters><QueryParameter Name="@EmployeeId"><Value>=Parameters!EmployeeId.Value</Value></QueryParameter></QueryParameters><CommandText>select round(avg(OprGrade),2) as AvgOPR from EmployeeOpr where EmployeeId=@EmployeeId and OprRankId in (9,10)</CommandText></Query><Fields><Field Name="AvgOPR"><DataField>AvgOPR</DataField><rd:TypeName>System.Double</rd:TypeName></Field></Fields></DataSet><DataSet Name="NotCdrRankOpr"><Query><DataSourceName>AppointmentProfileDS</DataSourceName><QueryParameters><QueryParameter Name="@EmployeeId"><Value>=Parameters!EmployeeId.Value</Value></QueryParameter></QueryParameters><CommandText>select round(avg(OprGrade),2) as AvgOPR from EmployeeOpr where EmployeeId=@EmployeeId and OprRankId not in (9,10)</CommandText></Query><Fields><Field Name="AvgOPR"><DataField>AvgOPR</DataField><rd:TypeName>System.Double</rd:TypeName></Field></Fields></DataSet></DataSets><ReportSections><ReportSection><Body><ReportItems><Textbox Name="Textbox7"><CanGrow>true</CanGrow><KeepTogether>true</KeepTogether><Paragraphs><Paragraph><TextRuns><TextRun><Value>a. Last 3 OPRs:</Value><Style><FontSize>8pt</FontSize></Style></TextRun></TextRuns><Style /></Paragraph></Paragraphs><rd:DefaultName>Textbox7</rd:DefaultName><Height>0.15972in</Height><Width>2.10417in</Width><Style><Border><Style>None</Style></Border><PaddingLeft>2pt</PaddingLeft><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop><PaddingBottom>2pt</PaddingBottom></Style></Textbox><Tablix Name="Tablix2"><TablixBody><TablixColumns><TablixColumn><Width>1.1in</Width></TablixColumn><TablixColumn><Width>0.5in</Width></TablixColumn></TablixColumns><TablixRows><TablixRow><Height>0.1in</Height><TablixCells><TablixCell><CellContents><Textbox Name="Recom"><CanGrow>true</CanGrow><KeepTogether>true</KeepTogether><Paragraphs><Paragraph><TextRuns><TextRun><Value>=Fields!Recom.Value</Value><Style><FontSize>8pt</FontSize></Style></TextRun></TextRuns><Style /></Paragraph></Paragraphs><rd:DefaultName>Recom</rd:DefaultName><Style><Border><Color>White</Color><Style>None</Style></Border><PaddingLeft>2pt</PaddingLeft><PaddingRight>2pt</PaddingRight></Style></Textbox></CellContents></TablixCell><TablixCell><CellContents><Textbox Name="OprGrade"><CanGrow>true</CanGrow><KeepTogether>true</KeepTogether><Paragraphs><Paragraph><TextRuns><TextRun><Value>-</Value><Style><FontSize>8pt</FontSize></Style></TextRun><TextRun><Value>=Fields!OprGrade.Value</Value><Style><FontSize>8pt</FontSize></Style></TextRun></TextRuns><Style><TextAlign>Left</TextAlign></Style></Paragraph></Paragraphs><rd:DefaultName>OprGrade</rd:DefaultName><Style><Border><Color>LightGrey</Color><Style>None</Style></Border><PaddingLeft>2pt</PaddingLeft><PaddingRight>2pt</PaddingRight></Style></Textbox></CellContents></TablixCell></TablixCells></TablixRow></TablixRows></TablixBody><TablixColumnHierarchy><TablixMembers><TablixMember /><TablixMember /></TablixMembers></TablixColumnHierarchy><TablixRowHierarchy><TablixMembers><TablixMember><Group Name="Details" /></TablixMember></TablixMembers></TablixRowHierarchy><DataSetName>LastOprRecom</DataSetName><Top>0.15972in</Top><Left>0.17708in</Left><Height>0.1in</Height><Width>1.6in</Width><ZIndex>1</ZIndex><Style><Border><Color>White</Color><Style>None</Style></Border></Style></Tablix><Textbox Name="Textbox8"><CanGrow>true</CanGrow><KeepTogether>true</KeepTogether><Paragraphs><Paragraph><TextRuns><TextRun><Value>b. Appt Recom Tenable by Capt: </Value><Style><FontSize>8pt</FontSize></Style></TextRun><TextRun><Value>=First(Fields!ApptRecom.Value, "ApptRecom")</Value><Style><FontSize>8pt</FontSize></Style></TextRun></TextRuns><Style /></Paragraph></Paragraphs><rd:DefaultName>Textbox7</rd:DefaultName><Top>0.32986in</Top><Height>0.15972in</Height><Width>2.10417in</Width><ZIndex>2</ZIndex><Style><Border><Style>None</Style></Border><PaddingLeft>2pt</PaddingLeft><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop><PaddingBottom>2pt</PaddingBottom></Style></Textbox><Textbox Name="Textbox9"><CanGrow>true</CanGrow><KeepTogether>true</KeepTogether><Paragraphs><Paragraph><TextRuns><TextRun><Value>c. All OPRs Avg -  </Value><Style><FontSize>8pt</FontSize></Style></TextRun><TextRun><Value>=first(Fields!AvgOPR.Value, "AllOprAvg")</Value><Style><FontSize>8pt</FontSize></Style></TextRun></TextRuns><Style /></Paragraph></Paragraphs><rd:DefaultName>Textbox7</rd:DefaultName><Top>0.48958in</Top><Height>0.15972in</Height><Width>2.10417in</Width><ZIndex>3</ZIndex><Style><Border><Style>None</Style></Border><PaddingLeft>2pt</PaddingLeft><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop><PaddingBottom>2pt</PaddingBottom></Style></Textbox><Textbox Name="Textbox10"><CanGrow>true</CanGrow><KeepTogether>true</KeepTogether><Paragraphs><Paragraph><TextRuns><TextRun><Value>d. Last 5 OPRs Avg (Min 6.5) -  </Value><Style><FontSize>8pt</FontSize></Style></TextRun><TextRun><Value>=first(Fields!AvgOPR.Value, "Last5Oprs")</Value><Style><FontSize>8pt</FontSize></Style></TextRun></TextRuns><Style /></Paragraph></Paragraphs><rd:DefaultName>Textbox7</rd:DefaultName><Top>0.6493in</Top><Height>0.15972in</Height><Width>2.10417in</Width><ZIndex>4</ZIndex><Style><Border><Style>None</Style></Border><PaddingLeft>2pt</PaddingLeft><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop><PaddingBottom>2pt</PaddingBottom></Style></Textbox><Textbox Name="Textbox11"><CanGrow>true</CanGrow><KeepTogether>true</KeepTogether><Paragraphs><Paragraph><TextRuns><TextRun><Value>e. Cdr rk OPRs Avg -  </Value><Style><FontSize>8pt</FontSize></Style></TextRun><TextRun><Value>=first(Fields!AvgOPR.Value, "CdrRankOpr")</Value><Style><FontSize>8pt</FontSize></Style></TextRun></TextRuns><Style /></Paragraph></Paragraphs><rd:DefaultName>Textbox7</rd:DefaultName><Top>0.80902in</Top><Height>0.15972in</Height><Width>2.10417in</Width><ZIndex>5</ZIndex><Style><Border><Style>None</Style></Border><PaddingLeft>2pt</PaddingLeft><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop><PaddingBottom>2pt</PaddingBottom></Style></Textbox><Textbox Name="Textbox12"><CanGrow>true</CanGrow><KeepTogether>true</KeepTogether><Paragraphs><Paragraph><TextRuns><TextRun><Value>f. OPRs Avg (Except Cdr rk) -  </Value><Style><FontSize>8pt</FontSize></Style></TextRun><TextRun><Value>=first(Fields!AvgOPR.Value, "NotCdrRankOpr")</Value><Style><FontSize>8pt</FontSize></Style></TextRun></TextRuns><Style /></Paragraph></Paragraphs><rd:DefaultName>Textbox7</rd:DefaultName><Top>0.99652in</Top><Height>0.15972in</Height><Width>2.10417in</Width><ZIndex>6</ZIndex><Style><Border><Style>None</Style></Border><PaddingLeft>2pt</PaddingLeft><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop><PaddingBottom>2pt</PaddingBottom></Style></Textbox><Textbox Name="Textbox13"><CanGrow>true</CanGrow><KeepTogether>true</KeepTogether><Paragraphs><Paragraph><TextRuns><TextRun><Value>g. Cdr rk Annual OPRs (Min 3):</Value><Style><FontSize>8pt</FontSize></Style></TextRun></TextRuns><Style /></Paragraph></Paragraphs><rd:DefaultName>Textbox7</rd:DefaultName><Top>1.15624in</Top><Height>0.15972in</Height><Width>2.10417in</Width><ZIndex>7</ZIndex><Style><Border><Style>None</Style></Border><PaddingLeft>2pt</PaddingLeft><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop><PaddingBottom>2pt</PaddingBottom></Style></Textbox><Textbox Name="Textbox14"><CanGrow>true</CanGrow><KeepTogether>true</KeepTogether><Paragraphs><Paragraph><TextRuns><TextRun><Value>h. Obesity (Last 3 OPRs) - Nil</Value><Style><FontSize>8pt</FontSize></Style></TextRun></TextRuns><Style /></Paragraph></Paragraphs><rd:DefaultName>Textbox7</rd:DefaultName><Top>1.81562in</Top><Height>0.2118in</Height><Width>2.10417in</Width><ZIndex>8</ZIndex><Style><Border><Style>None</Style></Border><PaddingLeft>2pt</PaddingLeft><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop><PaddingBottom>2pt</PaddingBottom></Style></Textbox><Textbox Name="Textbox15"><CanGrow>true</CanGrow><KeepTogether>true</KeepTogether><Paragraphs><Paragraph><TextRuns><TextRun><Value>Rec (Dec)-22</Value><Style><FontSize>8pt</FontSize></Style></TextRun></TextRuns><Style /></Paragraph><Paragraph><TextRuns><TextRun><Value>Rec (Dec)-22</Value><Style><FontSize>8pt</FontSize></Style></TextRun></TextRuns><Style /></Paragraph><Paragraph><TextRuns><TextRun><Value>Rec (Dec)-22</Value><Style><FontSize>8pt</FontSize></Style></TextRun></TextRuns><Style /></Paragraph></Paragraphs><rd:DefaultName>Textbox7</rd:DefaultName><Top>1.34374in</Top><Left>0.17708in</Left><Height>0.47189in</Height><Width>1.92709in</Width><ZIndex>9</ZIndex><Style><Border><Style>None</Style></Border><PaddingLeft>2pt</PaddingLeft><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop><PaddingBottom>2pt</PaddingBottom></Style></Textbox></ReportItems><Height>2.02743in</Height><Style /></Body><Width>2.10417in</Width><Page><PageHeight>11.69in</PageHeight><PageWidth>8.27in</PageWidth><LeftMargin>0.1in</LeftMargin><RightMargin>0.1in</RightMargin><TopMargin>0.2in</TopMargin><BottomMargin>0.2in</BottomMargin><Style /></Page></ReportSection></ReportSections><ReportParameters><ReportParameter Name="EmployeeId"><DataType>String</DataType><Prompt>Employee Id</Prompt></ReportParameter></ReportParameters><rd:ReportUnitType>Inch</rd:ReportUnitType><rd:ReportID>27ba0db4-3e6f-41c6-ab6b-ed11948d227a</rd:ReportID></Report>